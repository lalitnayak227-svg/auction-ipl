<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPL Mega Auction Simulator</title>
    <style>
        :root { --gold: #d4af37; --dark: #0a0a0a; --panel: #1e1e1e; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background: var(--dark);
            color: white;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* --- HEADER --- */
        header {
            background: linear-gradient(90deg, #1a237e, #000);
            padding: 15px;
            text-align: center;
            border-bottom: 2px solid var(--gold);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .live-tag { background: red; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; animation: pulse 1s infinite; }

        /* --- MAIN STAGE --- */
        #stage {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            background: radial-gradient(circle, #2c3e50 0%, #000 80%);
            position: relative;
        }

        #player-card {
            background: white;
            color: black;
            width: 320px;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.3);
            transform: scale(0.9);
            transition: transform 0.3s;
        }
        #player-card h1 { margin: 10px 0; font-size: 2rem; color: #333; }
        #player-role { background: #333; color: white; padding: 5px 15px; border-radius: 20px; display: inline-block; }
        #current-bid-box {
            margin-top: 20px;
            background: var(--dark);
            color: var(--gold);
            padding: 15px;
            border-radius: 10px;
        }
        .price-tag { font-size: 2.5rem; font-weight: bold; }
        
        #bid-timer {
            margin-top: 10px;
            font-size: 1.2rem;
            color: red;
            font-weight: bold;
            height: 20px;
        }

        /* --- LOGS & TEAMS --- */
        #panels {
            height: 30%;
            display: flex;
            border-top: 1px solid #333;
        }
        .panel { flex: 1; background: var(--panel); padding: 15px; overflow-y: auto; }
        .panel h3 { margin-top: 0; color: #aaa; border-bottom: 1px solid #444; padding-bottom: 5px; }
        
        #bid-log p { margin: 5px 0; font-family: monospace; border-bottom: 1px solid #333; }
        .log-high { color: #00ff00; }

        #team-list { font-size: 0.9rem; }
        .team-row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #333; }
        .active-bidder { color: var(--gold); font-weight: bold; }

        /* --- CONTROLS --- */
        #controls {
            background: #222;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 2px solid var(--gold);
        }
        #user-stats { font-size: 1.2rem; }
        button {
            background: var(--gold);
            border: none;
            padding: 15px 40px;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            color: #000;
            border-radius: 5px;
        }
        button:disabled { background: #555; cursor: not-allowed; }
        button:active { transform: scale(0.95); }

        /* --- MODAL --- */
        #team-select-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 100;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .team-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 20px; }
        .team-btn { padding: 15px; width: 150px; cursor: pointer; background: #333; color: white; border: 1px solid #555; }

        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
    </style>
</head>
<body>

    <div id="team-select-modal">
        <h1 style="color:var(--gold)">IPL AUCTION 2025</h1>
        <p>Select your Franchise to manage:</p>
        <div class="team-grid" id="team-grid"></div>
    </div>

    <header>
        <div><span class="live-tag">LIVE</span> MEGA AUCTION</div>
        <div id="status-text">Waiting to start...</div>
    </header>

    <div id="stage">
        <div id="player-card">
            <h2 id="p-name">Player Name</h2>
            <div id="player-role">Role</div>
            <div style="margin: 15px 0; font-size: 0.9rem; color: #666;">
                Base Price: ₹<span id="p-base">2.00</span> Cr
            </div>
            
            <div id="current-bid-box">
                <div style="font-size: 0.8rem; color:#aaa;">CURRENT BID</div>
                <div class="price-tag">₹<span id="curr-price">0.00</span> Cr</div>
                <div id="curr-holder" style="color: #fff; margin-top:5px;">No Bids Yet</div>
            </div>

            <div id="bid-timer"></div>
        </div>
    </div>

    <div id="panels">
        <div class="panel" style="flex: 2;">
            <h3>LIVE FEED</h3>
            <div id="bid-log"></div>
        </div>
        <div class="panel" style="flex: 1;">
            <h3>TEAM PURSES</h3>
            <div id="team-list"></div>
        </div>
    </div>

    <div id="controls">
        <div id="user-stats">
            Your Purse: <span style="color:var(--gold); font-weight:bold;">₹0 Cr</span>
        </div>
        <button id="bid-btn" onclick="userBid()">RAISE BID</button>
    </div>

<script>
    // --- DATA: REAL 2025 PURSE & PLAYER DATA ---
    
    // Approximate Purse remaining (in Crores) before the big auction starts
    const teamsData = [
        { id: 'PBKS', name: 'Punjab Kings', purse: 110.5, color: '#dd1f2d' },
        { id: 'RCB', name: 'Royal Challengers', purse: 83.0, color: '#db0030' },
        { id: 'DC', name: 'Delhi Capitals', purse: 73.0, color: '#0078bc' },
        { id: 'GT', name: 'Gujarat Titans', purse: 69.0, color: '#1b2133' },
        { id: 'LSG', name: 'Lucknow Super Giants', purse: 69.0, color: '#a0cef8' },
        { id: 'CSK', name: 'Chennai Super Kings', purse: 55.0, color: '#f9cd05' },
        { id: 'KKR', name: 'Kolkata Knight Riders', purse: 51.0, color: '#3a225d' },
        { id: 'MI', name: 'Mumbai Indians', purse: 45.0, color: '#004ba0' },
        { id: 'SRH', name: 'Sunrisers Hyderabad', purse: 45.0, color: '#f7a721' },
        { id: 'RR', name: 'Rajasthan Royals', purse: 41.0, color: '#ea1a85' }
    ];

    // Marquee Players (Real Base Prices & 'Hidden' Value for AI)
    // AI Value is the max random cap a bot might go to.
    const auctionPool = [
        { name: "Rishabh Pant", role: "Wicketkeeper", base: 2.00, aiVal: 27.00 },
        { name: "Shreyas Iyer", role: "Batter", base: 2.00, aiVal: 24.00 },
        { name: "KL Rahul", role: "Wicketkeeper", base: 2.00, aiVal: 18.00 },
        { name: "Arshdeep Singh", role: "Bowler", base: 2.00, aiVal: 16.00 },
        { name: "Yuzvendra Chahal", role: "Bowler", base: 2.00, aiVal: 12.00 },
        { name: "Mohammed Shami", role: "Bowler", base 2.00, aiVal: 11.00 },
        { name: "David Warner", role: "Batter", base: 2.00, aiVal: 8.00 },
        { name: "Ravichandran Ashwin", role: "All-Rounder", base: 2.00, aiVal: 7.50 },
        { name: "Ishan Kishan", role: "Wicketkeeper", base: 2.00, aiVal: 14.50 },
        { name: "Trent Boult", role: "Bowler", base: 2.00, aiVal: 10.00 }
    ];

    // --- GAME STATE ---
    let userTeamId = '';
    let currentPlayerIndex = -1;
    let currentBid = 0;
    let currentHolder = null; // Team Object
    let timerInterval = null;
    let botInterval = null;
    let isSold = false;
    let auctionStatus = 'waiting'; // waiting, bidding, sold

    // --- INITIALIZATION ---
    function init() {
        const grid = document.getElementById('team-grid');
        teamsData.forEach(t => {
            const btn = document.createElement('div');
            btn.className = 'team-btn';
            btn.innerHTML = `<b>${t.id}</b><br>₹${t.purse} Cr`;
            btn.onclick = () => startGame(t.id);
            grid.appendChild(btn);
        });
        updateTeamList();
    }

    function startGame(tid) {
        userTeamId = tid;
        document.getElementById('team-select-modal').style.display = 'none';
        updateUserStats();
        nextPlayer();
    }

    // --- AUCTION FLOW ---
    function nextPlayer() {
        currentPlayerIndex++;
        if (currentPlayerIndex >= auctionPool.length) {
            alert("Auction Ended!");
            return;
        }

        const p = auctionPool[currentPlayerIndex];
        
        // UI Reset
        document.getElementById('p-name').innerText = p.name;
        document.getElementById('player-role').innerText = p.role;
        document.getElementById('p-base').innerText = p.base.toFixed(2);
        document.getElementById('curr-price').innerText = p.base.toFixed(2);
        document.getElementById('curr-holder').innerText = "No Bids";
        document.getElementById('status-text').innerText = "ON THE BLOCK";
        document.getElementById('bid-log').innerHTML = ''; // Clear log
        
        // Logic Reset
        currentBid = p.base;
        currentHolder = null;
        isSold = false;
        auctionStatus = 'bidding';
        
        log(`--- ${p.name} is now on the block ---`);
        
        startBotLogic();
    }

    // --- BIDDING LOGIC ---
    function getIncrement(price) {
        if (price < 1) return 0.05;
        if (price < 2) return 0.10;
        if (price < 5) return 0.20;
        if (price < 10) return 0.25;
        return 0.50;
    }

    function placeBid(teamId) {
        if (isSold) return;

        // Clear any "Going Once" timers
        clearTimers();

        const team = teamsData.find(t => t.id === teamId);
        
        // Determine New Price
        let increment = 0;
        if (currentHolder === null) {
            // First bid is base price
            increment = 0; 
        } else {
            increment = getIncrement(currentBid);
        }
        
        const newPrice = currentBid + increment;

        // Validation: Can team afford it?
        if (newPrice > team.purse) {
            if(teamId === userTeamId) alert("Insufficient Funds!");
            return;
        }

        // Apply Bid
        if(currentHolder !== null) currentBid = newPrice; // Only increase if not first bid
        currentHolder = team;
        
        // Update UI
        document.getElementById('curr-price').innerText = currentBid.toFixed(2);
        document.getElementById('curr-holder').innerText = team.name;
        document.getElementById('curr-holder').style.color = team.color;
        
        const logEl = document.getElementById('bid-log');
        const entry = document.createElement('p');
        entry.innerHTML = `<span style="color:${team.color}"><b>${team.id}</b></span> bids ₹${currentBid.toFixed(2)} Cr`;
        logEl.prepend(entry);

        updateTeamList(); // Highlight active bidder
        
        // Start "Going Once..." Timer
        startSoldTimer();
    }

    function userBid() {
        if (currentHolder && currentHolder.id === userTeamId) return; // Don't bid against self
        placeBid(userTeamId);
    }

    // --- AI BOTS ---
    function startBotLogic() {
        if (botInterval) clearInterval(botInterval);
        
        botInterval = setInterval(() => {
            if (isSold) return;
            if (currentHolder && currentHolder.id === userTeamId) {
                // If User holds it, bots react faster
            }
            
            // 1. Pick a random bot that isn't the current holder
            const bots = teamsData.filter(t => t.id !== userTeamId && (currentHolder ? t.id !== currentHolder.id : true));
            const bot = bots[Math.floor(Math.random() * bots.length)];
            
            // 2. Decide to bid
            const p = auctionPool[currentPlayerIndex];
            const maxVal = p.aiVal; // How much is this bot willing to pay?
            
            // Random factor: small chance they stop bidding early
            const randomness = Math.random() * 2.0; 
            
            if (currentBid < (maxVal + randomness) && bot.purse > currentBid) {
                // Bot wants to bid, but add a human-like delay
                if (Math.random() > 0.6) { // 40% chance to bid on this tick
                     placeBid(bot.id);
                }
            }

        }, 1500); // Check every 1.5 seconds
    }

    // --- TIMER SYSTEM (Going Once, Twice...) ---
    let sellTimeout1, sellTimeout2, sellTimeout3;

    function clearTimers() {
        clearTimeout(sellTimeout1);
        clearTimeout(sellTimeout2);
        clearTimeout(sellTimeout3);
        document.getElementById('bid-timer').innerText = "";
    }

    function startSoldTimer() {
        // Wait 4 seconds, then Going Once
        sellTimeout1 = setTimeout(() => {
            document.getElementById('bid-timer').innerText = "Going Once...";
            // Wait 2 more seconds
            sellTimeout2 = setTimeout(() => {
                document.getElementById('bid-timer').innerText = "Going Twice...";
                // Wait 2 more seconds -> SOLD
                sellTimeout3 = setTimeout(() => {
                    sellPlayer();
                }, 2000);
            }, 2000);
        }, 4000);
    }

    function sellPlayer() {
        isSold = true;
        clearTimers();
        clearInterval(botInterval);

        if (currentHolder) {
            document.getElementById('bid-timer').innerText = "SOLD!";
            document.getElementById('status-text').innerText = `SOLD to ${currentHolder.id}`;
            
            // Deduct money
            currentHolder.purse -= currentBid;
            log(`*** SOLD to ${currentHolder.name} for ₹${currentBid.toFixed(2)} Cr ***`);
            
            updateTeamList();
            updateUserStats();
        } else {
            document.getElementById('bid-timer').innerText = "UNSOLD";
            log(`*** UNSOLD ***`);
        }

        // Delay before next player
        setTimeout(nextPlayer, 4000);
    }

    // --- UI UPDATERS ---
    function log(msg) {
        const logEl = document.getElementById('bid-log');
        const entry = document.createElement('p');
        entry.innerText = msg;
        logEl.prepend(entry);
    }

    function updateTeamList() {
        const list = document.getElementById('team-list');
        list.innerHTML = '';
        teamsData.sort((a,b) => b.purse - a.purse).forEach(t => {
            const div = document.createElement('div');
            div.className = 'team-row';
            if (currentHolder && currentHolder.id === t.id) div.classList.add('active-bidder');
            div.innerHTML = `<span>${t.id}</span> <span>₹${t.purse.toFixed(2)} Cr</span>`;
            list.appendChild(div);
        });
    }

    function updateUserStats() {
        const user = teamsData.find(t => t.id === userTeamId);
        document.querySelector('#user-stats span').innerText = `₹${user.purse.toFixed(2)} Cr`;
    }

    // Start
    init();

</script>
</body>
</html>